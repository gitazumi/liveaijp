@section('title', 'Chat')
<x-app-layout>
    <div class="flex justify-center h-screen overflow-y-hidden">
        <div class="h-[90%]  w-full rounded-xl p-[30px] sm:p-[50px] bg-[#E9F2FF]">
            <div class="flex items-center">
                <a href="{{ route('chat.history') }}">
                    <svg width="24" height="14" viewBox="0 0 24 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M8 14C8 13.258 7.267 12.15 6.525 11.22C5.571 10.02 4.431 8.973 3.124 8.174C2.144 7.575 0.956 7 -3.0598e-07 7M-3.0598e-07 7C0.956 7 2.145 6.425 3.124 5.826C4.431 5.026 5.571 3.979 6.525 2.781C7.267 1.85 8 0.74 8 -3.49691e-07M-3.0598e-07 7L24 7"
                            stroke="black" stroke-width="2" />
                    </svg>
                </a>
                <svg class="mx-2 sm:mx-5" width="32" height="32" viewBox="0 0 32 32" fill="none"
                    xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M15.651 19.0053C14.3597 19.0064 13.0882 18.6875 11.9502 18.0771C10.8123 17.4666 9.84334 16.5837 9.13006 15.5072L10.9926 14.2697C11.5024 15.0385 12.1946 15.6692 13.0075 16.1055C13.8203 16.5418 14.7285 16.7701 15.651 16.7701C16.5736 16.7701 17.4818 16.5418 18.2946 16.1055C19.1074 15.6692 19.7997 15.0385 20.3095 14.2697L22.172 15.5072C21.4587 16.5837 20.4898 17.4666 19.3518 18.0771C18.2139 18.6875 16.9424 19.0064 15.651 19.0053ZM20.1228 6.70788C19.6806 6.70788 19.2483 6.83901 18.8806 7.08469C18.5129 7.33038 18.2264 7.67958 18.0571 8.08813C17.8879 8.49669 17.8436 8.94625 17.9299 9.37997C18.0162 9.81369 18.2291 10.2121 18.5418 10.5248C18.8545 10.8375 19.2529 11.0504 19.6866 11.1367C20.1203 11.223 20.5699 11.1787 20.9785 11.0095C21.387 10.8402 21.7362 10.5537 21.9819 10.186C22.2276 9.81828 22.3587 9.38599 22.3587 8.94377C22.3617 8.64932 22.3059 8.35723 22.1946 8.08461C22.0833 7.81199 21.9187 7.56431 21.7105 7.35609C21.5023 7.14787 21.2546 6.98329 20.982 6.87198C20.7094 6.76068 20.4173 6.70489 20.1228 6.70788ZM11.1793 6.70788C10.737 6.70788 10.3047 6.83901 9.93706 7.08469C9.56937 7.33038 9.28279 7.67958 9.11356 8.08813C8.94433 8.49669 8.90005 8.94625 8.98632 9.37997C9.07259 9.81369 9.28554 10.2121 9.59824 10.5248C9.91093 10.8375 10.3093 11.0504 10.7431 11.1367C11.1768 11.223 11.6263 11.1787 12.0349 11.0095C12.4434 10.8402 12.7926 10.5537 13.0383 10.186C13.284 9.81828 13.4151 9.38599 13.4151 8.94377C13.4181 8.64932 13.3623 8.35723 13.251 8.08461C13.1397 7.81199 12.9752 7.56431 12.7669 7.35609C12.5587 7.14787 12.311 6.98329 12.0384 6.87198C11.7658 6.76068 11.4737 6.70489 11.1793 6.70788Z"
                        fill="currentColor" />
                    <path
                        d="M17.592 31.3025L15.6512 30.1846L20.123 22.3589H26.8307C27.1245 22.3594 27.4154 22.3018 27.6869 22.1896C27.9583 22.0774 28.205 21.9127 28.4127 21.705C28.6204 21.4973 28.7851 21.2507 28.8973 20.9792C29.0095 20.7077 29.067 20.4168 29.0666 20.123V4.47179C29.067 4.17804 29.0095 3.88709 28.8973 3.61562C28.7851 3.34415 28.6204 3.0975 28.4127 2.88979C28.205 2.68208 27.9583 2.5174 27.6869 2.40519C27.4154 2.29298 27.1245 2.23545 26.8307 2.23589H4.47179C4.17804 2.23545 3.88709 2.29298 3.61562 2.40519C3.34415 2.5174 3.0975 2.68208 2.88979 2.88979C2.68208 3.0975 2.5174 3.34415 2.40519 3.61562C2.29298 3.88709 2.23545 4.17804 2.23589 4.47179V20.123C2.23545 20.4168 2.29298 20.7077 2.40519 20.9792C2.5174 21.2507 2.68208 21.4973 2.88979 21.705C3.0975 21.9127 3.34415 22.0774 3.61562 22.1896C3.88709 22.3018 4.17804 22.3594 4.47179 22.3589H14.5333V24.5948H4.47179C3.28579 24.5948 2.14838 24.1237 1.30976 23.2851C0.471133 22.4464 0 21.309 0 20.123V4.47179C0 3.28579 0.471133 2.14838 1.30976 1.30976C2.14838 0.471133 3.28579 0 4.47179 0H26.8307C28.0167 0 29.1541 0.471133 29.9927 1.30976C30.8314 2.14838 31.3025 3.28579 31.3025 4.47179V20.123C31.3025 21.309 30.8314 22.4464 29.9927 23.2851C29.1541 24.1237 28.0167 24.5948 26.8307 24.5948H21.4254L17.592 31.3025Z"
                        fill="currentColor" />
                </svg>

                <span class="text-[20px] sm:text-[28.95px] font-semibold">
                    Chat
                </span>
            </div>

            <div id="message-list" class="max-h-[90%] overflow-y-auto w-full">
                {{-- chats --}}
                <div class="flex-1 overflow-y-auto p-1 sm:p-3 mb-2">
                    @forelse ($chats->messages as $chat)
                        @if ($chat->send_by)
                            <div class="flex mb-5">
                                <div class="mr-2">
                                    <svg width="50" height="50" viewBox="0 0 24 24" fill="none"
                                        xmlns="http://www.w3.org/2000/svg">
                                        <path opacity="0.4"
                                            d="M12 22.01C17.5228 22.01 22 17.5329 22 12.01C22 6.48716 17.5228 2.01001 12 2.01001C6.47715 2.01001 2 6.48716 2 12.01C2 17.5329 6.47715 22.01 12 22.01Z"
                                            fill="#FFFFFF" />
                                        <path
                                            d="M12 6.93994C9.93 6.93994 8.25 8.61994 8.25 10.6899C8.25 12.7199 9.84 14.3699 11.95 14.4299C11.98 14.4299 12.02 14.4299 12.04 14.4299C12.06 14.4299 12.09 14.4299 12.11 14.4299C12.12 14.4299 12.13 14.4299 12.13 14.4299C14.15 14.3599 15.74 12.7199 15.75 10.6899C15.75 8.61994 14.07 6.93994 12 6.93994Z"
                                            fill="#173F74" />
                                        <path
                                            d="M18.7807 19.36C17.0007 21 14.6207 22.01 12.0007 22.01C9.3807 22.01 7.0007 21 5.2207 19.36C5.4607 18.45 6.1107 17.62 7.0607 16.98C9.7907 15.16 14.2307 15.16 16.9407 16.98C17.9007 17.62 18.5407 18.45 18.7807 19.36Z"
                                            fill="#173F74" />
                                    </svg>
                                </div>
                                <div
                                    class="bg-[#D0E4FF] border border-[#344EAB] p-1 px-3 rounded relative min-h-[70px] w-full">
                                    <p class="text-[16px] sm:text-[20px] font-semibold mb-5">
                                        {{ $chat->message }}
                                    </p>

                                    <small class="text-16px absolute bottom-[2px]">
                                        {{ date('Y-m-d H:i', strtotime($chat->created_at)) }}
                                    </small>
                                </div>
                            </div>
                        @else
                            <div class="flex mb-5">
                                <div
                                    class="bg-[#D0E4FF] border border-[#344EAB] p-1 px-3 rounded relative min-h-[70px] w-full">
                                    <p class="text-[16px] sm:text-[20px] font-semibold mb-5">
                                        {{ $chat->message }}
                                    </p>

                                    <small class="text-16px absolute bottom-[2px]">
                                        {{ date('Y-m-d H:i', strtotime($chat->created_at)) }}
                                    </small>
                                </div>
                                <div class="ml-2">
                                    <svg width="40" height="40" viewBox="0 0 38 48" fill="none"
                                        xmlns="http://www.w3.org/2000/svg">
                                        <path
                                            d="M32.6561 28.4995C35.6074 28.4995 38 30.8921 38 33.8434V35.9931C38 38.5906 36.866 41.0587 34.8951 42.7508C31.1771 45.9428 25.8561 47.5028 18.9922 47.5028C12.1294 47.5028 6.81205 45.9433 3.10013 42.752C1.13209 41.06 0 38.5938 0 35.9984V33.8434C0 30.8921 2.39255 28.4995 5.34391 28.4995H32.6561ZM18.7512 0.0162613L18.993 0C19.8948 0 20.64 0.670136 20.758 1.53959L20.7743 1.7813L20.7724 3.56023L29.0862 3.56144C32.0376 3.56144 34.4301 5.95399 34.4301 8.90535V19.6041C34.4301 22.5554 32.0376 24.948 29.0862 24.948H8.89811C5.94675 24.948 3.5542 22.5554 3.5542 19.6041V8.90535C3.5542 5.95399 5.94675 3.56144 8.89811 3.56144L17.2098 3.56023L17.2117 1.7813C17.2117 0.879499 17.8818 0.134213 18.7512 0.0162613ZM13.6466 10.6867C12.0079 10.6867 10.6794 12.0151 10.6794 13.6538C10.6794 15.2925 12.0079 16.621 13.6466 16.621C15.2853 16.621 16.6137 15.2925 16.6137 13.6538C16.6137 12.0151 15.2853 10.6867 13.6466 10.6867ZM24.3171 10.6867C22.6784 10.6867 21.35 12.0151 21.35 13.6538C21.35 15.2925 22.6784 16.621 24.3171 16.621C25.9559 16.621 27.2843 15.2925 27.2843 13.6538C27.2843 12.0151 25.9559 10.6867 24.3171 10.6867Z"
                                            fill="#173F74" />
                                    </svg>
                                </div>
                            </div>
                        @endif
                    @empty
                        <div class="bg-[#D0E4FF] border border-[#344EAB] p-1 px-3 rounded text-red-500 py-3">
                            No record found
                        </div>
                    @endforelse
                </div>
            </div>

        </div>

    </div>

    <script>
        function scrollToBottom() {
            const messageList = document.getElementById('message-list');
            setTimeout(() => {
                messageList.scrollTo({
                    top: messageList.scrollHeight,
                    behavior: 'smooth'
                });
            }, 1500);
        }
        document.addEventListener('DOMContentLoaded', scrollToBottom);
    </script>
</x-app-layout>
